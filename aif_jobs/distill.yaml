compute:
  image: harbor.global.lmco.com/torchavaylon/py312-torch-cu118:2.0
  replicas: 1
  resources:
    cpuRequest: 6
    cpuLimit: 24
    memoryRequest: 16
    memoryLimit: 64
    gpu: 2
    gpuType: NVIDIA-A100-SXM4-80GB

dataVolumes: 
  - name: 'mask2former'
    mountPath: '/home/jovyan/mask2former'
    mountReadOnly: false
  - name: 'm2f-teacher-logits'
    mountPath: '/home/jovyan/m2f-teacher-logits'
    mountReadOnly: false
  - name: 'mask2former-weights'
    mountPath: '/home/jovyan/mask2former-weights'
    mountReadOnly: false

name: mask2former-with-detectron2
provider: k8s

run:
  command: |
    set -euo pipefail

    echo "=== START ==="
    echo "Current directory:"
    cd
    cd /home/jovyan/mask2former
    pwd
    ls -a
    
    ./train.sh configs/ade20k/semantic-segmentation/swin/KD/maskformer2_swin_KD_tiny_bs16_160k.yaml distill_local
    